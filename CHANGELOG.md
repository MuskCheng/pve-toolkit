# 更新日志

所有重要的更改都将记录在此文件中。

## [V0.5.14] - 2026-02-22

### 新增

- **Docker 换源功能**
  - Docker 管理菜单新增"换源"选项
  - 支持多个国内镜像源：阿里云、中科大、网易、腾讯云、Docker中国
  - 支持自定义镜像源
  - 自动配置 /etc/docker/daemon.json
  - 自动重启 Docker 服务并验证

### 修复

- **Docker Compose 路径问题**
  - 使用完整路径调用 docker-compose（/usr/local/bin/docker-compose）
  - 解决容器内 PATH 未包含 /usr/local/bin 导致命令找不到的问题

## [V0.5.13] - 2026-02-22

### 修复

- **Docker Compose 安装稳定性修复**
  - 使用固定版本 v2.24.0 替代动态获取最新版本（避免 v5.x 文件名不兼容）
  - 增加下载文件完整性验证：
    - 检查文件大小 > 1MB
    - 检查文件头是否为 HTML（避免 404 页面）
    - 使用 `file` 命令验证 ELF 可执行文件格式
    - 验证 `--version` 输出包含 "Docker Compose"
  - 验证失败时自动删除无效文件

## [V0.5.12] - 2026-02-22

### 修复

- **容器内命令检测修复**
  - 使用 `bash -lc` 替代 `bash -c`，确保加载用户环境变量
  - 添加文件路径检测作为备用（`/usr/bin/docker`, `/usr/local/bin/docker-compose`）
  - 解决 LXC 容器中 PATH 未正确设置导致命令检测失败的问题

- **Docker Compose 安装改进**
  - 添加 curl/wget 安装状态变量检测
  - 显示 curl/wget 安装结果
  - 使用绝对路径验证 docker-compose 安装

## [V0.5.11] - 2026-02-22

### 修复

- **Docker 检测逻辑优化**
  - 使用 `command -v docker` 检测，更可靠
  - 添加服务启动尝试逻辑
  - 解决已安装 Docker 但检测不到的问题

- **Docker Compose 安装重构**
  - 版本获取移至容器内执行（而非宿主机）
  - 添加 curl/wget 安装验证
  - 移除 apt 安装方式（Debian Trixie 无 docker-compose-plugin 包）
  - 改进下载逻辑：添加超时参数，使用 -f 强制失败检测
  - 支持 docker-compose V1 和 docker compose V2 plugin

## [V0.5.10] - 2026-02-22

### 重构

- **主菜单精简**
  - 删除备份管理、VM 管理、常用工具等非核心功能
  - 主菜单从 8 项精简为 3 项
  - 代码行数从 1652 行减少至 ~1000 行

### 新增

- **容器操作子菜单**
  - LXC 容器管理新增"容器操作"子菜单
  - 整合控制台/启动/停止/重启/克隆/修改资源功能

- **系统清理增强**
  - 新增多种清理选项：apt 缓存、旧内核、临时文件
  - 支持单独或完整清理

### 优化

- **Docker 环境检测**
  - 支持 Docker Compose V1/V2 兼容检测
  - 部署前自动检查并安装 Docker 环境

- **LXC 创建优化**
  - 创建容器时询问是否预装 Docker 环境

## [V0.5.7] - 2026-02-22

### 修复

- **Docker 安装**
  - 修复 Docker Compose 安装失败问题
  - 改进安装逻辑，支持多种安装方式（apt → pip → 二进制）

## [V0.5.6] - 2026-02-22

### 新增

- **LXC 创建容器**
  - 增加磁盘空间建议提示
  - 默认磁盘大小从 20GB 调整为 8GB

## [V0.5.5] - 2026-02-22

### 新增

- **Docker 管理功能增强**
  - 新增 Docker 部署向导（使用 docker run 部署单个容器）
  - 支持在线选择热门镜像（Nginx, MySQL, PostgreSQL, Redis, MongoDB, etc.）
  - Docker Compose 部署向导新增自定义部署（粘贴 docker-compose.yml）
  - 所有部署向导自动检查并安装 Docker/Docker Compose

### 优化

- Docker 管理菜单结构调整
- 安装 Docker 时自动包含 Docker Compose

## [V0.5.4] - 2026-02-22

### 修复

- **LXC 创建容器**
  - 修复模板名称包含状态信息问题

## [V0.5.3] - 2026-02-22

### 修复

- **LXC 创建容器**
  - 修复模板名称错误导致容器创建失败

## [V0.5.2] - 2026-02-22

### 新增

- **LXC 创建容器优化**
  - 创建容器默认使用最新模板，移除手动选择

## [V0.5.1] - 2026-02-22

### 新增

- **LXC 创建容器优化**
  - 下载新模板后自动清理旧版 Debian 模板
  - 创建容器前显示当前 LXC 容器列表

## [V0.5.0] - 2026-02-22

### 新增

- **LXC 创建容器优化**
  - 自动检测并下载 Proxmox 官方镜像库中最新 Debian 模板
  - 创建容器时自动使用最新模板
  - 本地模板已存在时跳过下载
  - 用户仍可手动选择其他模板

## [V0.38] - 2026-02-21

### 新增

- **LXC 创建容器优化**
  - 创建容器前显示已下载的 LXC 模板列表
  - 支持用户选择使用哪个模板
  - 默认使用 debian-12-standard 模板
- **Docker 管理增强**
  - 新增独立的 Docker 管理子菜单
  - 安装 Docker / Docker Compose
  - Docker Compose 部署向导（预置9种常用服务模板）
  - 一键升级镜像功能
- **版本管理优化**
  - 创建 VERSION 文件统一管理版本号
  - 启动时自动查询 GitHub 最新版本

## [V0.28] - 2026-02-21

### 重构

- 移除交互模式，改为纯命令行模式
- 解决管道执行的闪屏问题
- 代码精简至约 150 行

## [V0.18] - 2026-02-21

### 修复

- 安装脚本对 apt 镜像源错误更宽容
- 修复 Docker 安装兼容性问题（支持多源回退：官方源→阿里云源→系统自带）

## [V0.1] - 初始版本

### 新增

- **主框架**
  - 交互式菜单界面
  - 命令行模式支持
  - ASCII Logo 显示
- **备份管理模块**
  - 列出所有 VM/LXC 备份
  - 创建备份（支持 snapshot 模式）
  - 清理过期备份
  - 恢复备份
- **系统监控模块**
  - 系统状态概览（CPU/内存/磁盘/运行时间）
  - 虚拟机状态列表
  - LXC 容器状态列表
  - 资源阈值检查告警
  - 网络接口状态
  - 系统日志查看
- **LXC 容器管理模块**
  - 列出所有容器
  - 创建容器（支持自定义配置）
  - 启动/停止/重启容器
  - 删除容器（支持强制删除）
  - 容器详情查看
  - Docker 安装（使用阿里云镜像源加速）
  - Docker Compose 安装（使用 pip）
  - Docker 镜像源切换（6 个国内镜像源）
  - Docker 容器管理（镜像搜索、拉取、运行）
- **系统管理模块**
  - 显示镜像源配置
  - 切换镜像源（6 个国内镜像源）
  - 禁用 PVE 企业源
  - 配置 PVE 社区源
  - 系统更新
  - 系统清理
  - 系统信息显示
